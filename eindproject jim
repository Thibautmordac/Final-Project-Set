import os
import sys
import random

class Kaarten:
    def __init__(self, color, symbol, shading, number):
        self.number = number
        self.symbol = symbol
        self.color = color
        self.shading = shading
    
kleuren = {'r':'red', 'g': 'green', 'p': 'purple'}
symbolen = {'d': 'diamond', 's': 'squiggle', 'o': 'oval'}
schaduw = {'e': 'empty', 'f': 'filled', 's': 'shaded'}

basis = os.path.dirname(os.path.abspath(__file__))
kaarten = os.path.join(basis, 'kaarten')

fotos = os.listdir(kaarten) #is een lijst van de bestandsnamen van foto's
stapel = [os.path.splitext(f)[0] for f in fotos] #de stapel kaarten

def kaart_trekken(deck):
    kaart = random.choice(deck)
    deck.remove(kaart)
    return kaart

def displaying_cards(): #de kaarten die op 'tafel' liggen
    displayed = []
    while len(displayed) < 12:
        displayed.append(kaart_trekken(stapel))
    return displayed

kaarten_op_tafel = displaying_cards()

from PIL import Image #geeft bijhorende afbeelding bij naam van een kaart
def show_table(cards):
    beginkaart = Image.open(os.path.join(kaarten, f'{cards[0]}.gif'))
    b, h = beginkaart.size
    r = 3
    k = 4
    alles = Image.new('RGBA', (k*b, r*h), (255, 255, 255, 255)) #'alles' is een afbeelding van 12 kaarten

    for x, card in enumerate(cards): 
        foto = Image.open(os.path.join(kaarten, f'{card}.gif'))
        p = (x%k)*b
        q = (x//k)*h
        alles.paste(foto, (p, q))

    alles.show()

def eigenschappen_van_kaart(card): #Vindt de eigenschappen van een kaart en zet het om in een Kaart object.
    color = kleuren[card[0]]
    card1 = card[len(kleuren[card[0]]):]
    symbol = symbolen[card1[0]]
    card2 = card1[len(symbolen[card1[0]]):]
    shading = schaduw[card2[0]]
    number = card2[len(schaduw[card2[0]]):]
    eigenschappen_van_kaart = Kaarten(color, symbol, shading, number)
    return eigenschappen_van_kaart

def is_set(card1, card2, card3):
        eigenschappen = ["color", "symbol", "shading", "number"]
        for eig in eigenschappen:
            waarden = {getattr(card1, eig), getattr(card2, eig), getattr(card3, eig)}
            if len(waarden) == 2:
                return False
        return True 
    
